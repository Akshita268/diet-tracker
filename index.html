<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Discipline</title>

<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<link rel="apple-touch-icon" sizes="512x512" href="icon-512.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#0f172a">

<style>
:root{
  --bg:#020617;
  --card:rgba(15,23,42,.75);
  --border:#334155;
  --green:#22c55e;
  --yellow:#facc15;
  --orange:#fb923c;
  --red:#ef4444;
  --accent:#38bdf8;
}
*{box-sizing:border-box;font-family:Inter,system-ui,sans-serif}
body{
  margin:0;
  background:radial-gradient(circle at top,#0f172a,#020617);
  color:#fff;
  min-height:100vh;
}
.app{
  max-width:390px;
  margin:auto;
  padding:16px;
}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:20px;
  padding:18px;
  backdrop-filter:blur(14px);
  margin-bottom:14px;
}
h1{
  text-align:center;
  margin:10px 0 14px;
  font-weight:800;
  letter-spacing:.5px;
}
button{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  font-weight:800;
  cursor:pointer;
  margin-bottom:10px;
}
.clean{background:linear-gradient(135deg,var(--green),#16a34a)}
.junk{background:linear-gradient(135deg,var(--red),#b91c1c)}
.secondary{
  background:#020617;
  color:#94a3b8;
  border:1px solid var(--border);
}
.hidden{display:none}
.msg{
  text-align:center;
  min-height:40px;
  opacity:.85;
}

/* Tabs */
.tabs{
  display:flex;
  gap:8px;
}
.tab{
  flex:1;
  padding:10px;
  text-align:center;
  border-radius:12px;
  border:1px solid var(--border);
  cursor:pointer;
  font-weight:700;
}
.tab.active{
  background:linear-gradient(135deg,#38bdf8,#0ea5e9);
  color:#020617;
}

/* Calendar */
.calendar{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:6px;
  font-size:12px;
}
.day{
  padding:10px 0;
  text-align:center;
  border-radius:10px;
  background:#020617;
  border:1px solid var(--border);
}
.clean-day{background:rgba(34,197,94,.8)}
.low-day{background:rgba(250,204,21,.85);color:#000}
.medium-day{background:rgba(251,146,60,.9)}
.high-day{background:rgba(239,68,68,.9)}

/* Stats */
.stat{
  display:flex;
  justify-content:space-between;
  margin-bottom:8px;
  font-size:14px;
}
.progress{
  height:10px;
  background:#020617;
  border-radius:999px;
  overflow:hidden;
}
.progress span{
  display:block;
  height:100%;
  background:linear-gradient(90deg,#22c55e,#16a34a);
}
</style>
</head>

<body>
<div class="app">

<h1>DISCIPLINE</h1>

<div class="tabs">
  <div class="tab active" onclick="showScreen('home')">Today</div>
  <div class="tab" onclick="showScreen('calendar')">Calendar</div>
  <div class="tab" onclick="showScreen('stats')">Stats</div>
</div>

<!-- HOME -->
<div id="home" class="card">
  <button class="clean" onclick="markClean()">✔ Stayed Clean Today</button>
  <button class="junk" onclick="toggleLevels()">✖ Ate Junk Today</button>

  <div id="levels" class="hidden">
    <button class="junk" onclick="markJunk('low')">Low junk</button>
    <button class="junk" onclick="markJunk('medium')">Medium junk</button>
    <button class="junk" onclick="markJunk('high')">High junk</button>
  </div>

  <div class="msg" id="msg">No report yet today.</div>
</div>

<!-- CALENDAR -->
<div id="calendar" class="card hidden">
  <h3 id="monthYear"></h3>
  <div class="calendar" id="calendarGrid"></div>
</div>

<!-- STATS -->
<div id="stats" class="card hidden">
  <div class="stat"><span>Clean days</span><span id="cleanPct">0%</span></div>
  <div class="progress"><span id="cleanBar"></span></div>

  <div class="stat"><span>Low junk</span><span id="lowPct">0%</span></div>
  <div class="stat"><span>Medium junk</span><span id="mediumPct">0%</span></div>
  <div class="stat"><span>High junk</span><span id="highPct">0%</span></div>
</div>

</div>

<script>
const KEY="disciplineData";
let data=JSON.parse(localStorage.getItem(KEY))||{};
let current=new Date();

function dateKey(d=new Date()){
  return d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0")+"-"+String(d.getDate()).padStart(2,"0");
}
function save(){localStorage.setItem(KEY,JSON.stringify(data));}

function markClean(){
  data[dateKey()]={status:"clean"};
  msg.textContent="Clean day recorded.";
  save();renderCalendar();renderStats();
}
function toggleLevels(){
  levels.classList.toggle("hidden");
}
function markJunk(level){
  data[dateKey()]={status:"junk",level};
  levels.classList.add("hidden");
  msg.textContent=`Junk (${level}) recorded.`;
  save();renderCalendar();renderStats();
}

/* Screens */
function showScreen(id){
  ["home","calendar","stats"].forEach(s=>{
    document.getElementById(s).classList.add("hidden");
  });
  document.getElementById(id).classList.remove("hidden");
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  event.target.classList.add("active");
  if(id==="calendar")renderCalendar();
  if(id==="stats")renderStats();
}

/* Calendar */
function renderCalendar(){
  const grid=calendarGrid;
  grid.innerHTML="";
  const y=current.getFullYear(),m=current.getMonth();
  monthYear.textContent=current.toLocaleString("default",{month:"long",year:"numeric"});
  const days=new Date(y,m+1,0).getDate();
  for(let d=1;d<=days;d++){
    const k=dateKey(new Date(y,m,d));
    const cell=document.createElement("div");
    cell.className="day";
    cell.textContent=d;
    if(data[k]){
      if(data[k].status==="clean")cell.classList.add("clean-day");
      if(data[k].level==="low")cell.classList.add("low-day");
      if(data[k].level==="medium")cell.classList.add("medium-day");
      if(data[k].level==="high")cell.classList.add("high-day");
    }
    grid.appendChild(cell);
  }
}

/* Stats */
function renderStats(){
  const y=current.getFullYear(),m=current.getMonth();
  const days=new Date(y,m+1,0).getDate();
  let clean=0,low=0,med=0,high=0;
  for(let d=1;d<=days;d++){
    const k=dateKey(new Date(y,m,d));
    if(data[k]){
      if(data[k].status==="clean")clean++;
      if(data[k].level==="low")low++;
      if(data[k].level==="medium")med++;
      if(data[k].level==="high")high++;
    }
  }
  const pct=x=>Math.round((x/days)*100);
  cleanPct.textContent=pct(clean)+"%";
  lowPct.textContent=pct(low)+"%";
  mediumPct.textContent=pct(med)+"%";
  highPct.textContent=pct(high)+"%";
  cleanBar.style.width=pct(clean)+"%";
}

renderCalendar();
renderStats();
</script>
</body>
</html>
